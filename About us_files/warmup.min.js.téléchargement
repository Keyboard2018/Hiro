var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("warmup/bi/events.json",[],function(){return{SERVER_SIDE_RENDERING_FLOW:{eventId:380,adapter:"ugc-viewer",sampleRatio:1,params:{phase_name:"phase",status:"status",warning_msg:"warningMessage",isBot:"isBot"}}}}),define("warmup/bi/events",["warmup/bi/events.json","lodash","warmupUtils"],function(e,t,n){"use strict";return n.loggingUtils.logger.register("warmup","event",e),e}),define("warmup/lib/bodyStub",["warmupUtils"],function(e){"use strict";return{generate:function(){var t=window.document.createElement("DIV");t.setAttribute("id","SITE_CONTAINER"),window.document.body.appendChild(t),window.clientSideRender=!0,window.santaRenderingError={errorInfo:e.constants.BODY_NOT_RENDERED_ERR}}}}),define("warmup/lib/layout",["lodash","warmupUtils","layout","experiment"],function(e,t,n,r){"use strict";function a(a,o){o=o||e.noop;var s=a.getRootNavigationInfo(),u=s.pageId,l=e.isEmpty(a.notRenderedStructures),d=function(n,r){if(!r)return e.forOwn(n.notRenderedStructures,function(e,t){"undefined"!==t&&(e.getDomNodeFunc=i)});var a={};return a.inner=t.structuresDescription.getInner(n,i),a.outer=t.structuresDescription.getOuter(n,i),a.siteBackground=t.structuresDescription.getSiteBackground(n,i),a.wixAds=t.structuresDescription.getWixAds(n),a}(a,l),c={getSiteData:function(){return a},getAllRenderedRootIds:function(){return["masterPage",u]},getRuntimeDal:function(){return{getCompData:function(){return null},getCompDesign:function(){return null},getCompProps:function(){return null},getActionsAndBehaviors:function(){return null}}},getLayoutMechanism:function(){return t.layoutUtils.getLayoutMechanism(a)},isExperimentOpen:function(e){return r.isOpen(e,a)}};t.mobileViewportFixer.fixViewportTag(a),n.updateBodyNodeStyle(a),n.reLayout(d,c),l&&(i("masterPage").style.visibility="",i(s.pageId).style.visibility=""),o()}function i(){var t=e.toArray(arguments),n=t.join(""),r=window.document.getElementById(n);if(!r){var a=t[0],i=t.slice(1).map(function(e){return e.replace(a,"")}).join("");r=window.document.getElementById(a+i)}return r}return{runLayout:function(t,n){var r=e.keys(e.get(window,"warmupData.wixapps",{})).length>1?["wixappsLayout"]:[];requirejs(r,a.bind(null,t,n))}}}),define("warmup/lib/anchorLinkHandler",["lodash","zepto","warmupUtils"],function(e,t,n){"use strict";var r=n.siteConstants.PAGE_ANCHORS,a="data-originalHref";return{patchAnchorLinks:function(n,i){var o={};e.set(o,r.TOP_ANCHOR_ID,"prepend"),e.set(o,r.BOTTOM_ANCHOR_ID,"append"),e.forEach(o,function(e,n){if(0===window.document.querySelectorAll(n).length){var r=window.document.createElement("A");r.setAttribute("id",n),t(window.document.body)[e](r)}}),t("a[data-anchor]").each(function(t,r){var o=r.getAttribute("data-anchor"),s=e.get(n.getDataByQuery(o),"compId",o);if(!e.includes(r.href,"#")&&r.href===i){var u=r.getAttribute("href");r.setAttribute(a,u),r.setAttribute("href","#"+s)}})},restoreAnchorLinks:function(){t("a[data-originalHref]").each(function(e,t){var n=t.getAttribute(a);t.setAttribute("href",n),t.removeAttribute(a)})}}}),define("warmup/lib/indicator",[],function(){"use strict";var e=void 0,t={INITIAL:"initial",WARMUP:"warmup",SUCCESS:"success",FAIL:"fail",RENDERING:"rendering",STANDBY:"standby"};function n(t){e&&(e.innerHTML=t,e.setAttribute("class",t))}return{init:function(r){!function(){var e=window.document.createElement("style");e.appendChild(window.document.createTextNode("")),window.document.body.appendChild(e),e.sheet.insertRule("#warmup-indicator { padding: 6px; font-size: 12px; position: fixed; bottom: 0; left: 0; z-index: 2147483647; border: 2px solid black; text-align: center; border-radius: 4px; text-transform: capitalize; background-color: yellow; }",0),e.sheet.insertRule("#warmup-indicator.layout { background-color: orange; }",0),e.sheet.insertRule("#warmup-indicator.success { background-color: green; }",0),e.sheet.insertRule("#warmup-indicator.fail { background-color: red; }",0),e.sheet.insertRule("#warmup-indicator.standby { background-color: cyan; }",0),e.sheet.insertRule("#warmup-indicator.rendering { background-color: white; }",0)}(),a=r,(e=window.document.createElement("div")).setAttribute("id","warmup-indicator"),e.addEventListener("click",a),window.document.body.appendChild(e);var a;n(t.INITIAL)},updateState:n,STATES:t}}),define("warmup/lib/iframesHandler",["zepto","lodash"],function(e,t){"use strict";var n=[];function r(e){var r=t.filter(n,{ref:this})[0];r.isLoaded=!0,r.event=e}return{registerIframesOnLoad:function(){e("iframe[data-src]").forEach(function(e){n.push({ref:e,isLoaded:!1}),e.addEventListener("load",r,!1)})},flushEvents:function(){n.forEach(function(e){e.ref.removeEventListener("load",r)}),t(n).filter(function(e){return e.isLoaded&&"function"==typeof e.ref.onload}).forEach(function(e){e.ref.onload(e.event)}),n=null}}}),define("warmup/lib/tpaStyleUtils",["lodash","warmupUtils"],function(e,t){"use strict";var n=["latin-ext","cyrillic","japanese","korean","arabic","hebrew","latin"],r="param_font_";function a(e,n){var r=e&&e.scriptsDomainUrl||"https://static.parastorage.com/";return t.urlUtils.joinURL(r,"services","santa-resources","resources","viewer",n)}var i=function(t,n,r){var i=function(t,n){var r=function(e,t){var n={langauges:a(e,"user-site-fonts/v5/languages.css")};"WixSite"===t&&(n.helveticas=a(e,"user-site-fonts/v3/helvetica.css"));return n}(t,n);return e.values(r)}(t,n);return r||(i=e.invokeMap(i,String.prototype.replace,/^https?\:/,"")),i};var o=function(t){var n=0;return e.reduce(u(),function(e,r,a){return e[a]=s(t[n++],r),e},{})},s=function(e,n){var r=t.fonts.parseFontStr(e),a=t.fonts.getFontFamilyWithFallbacks(r.family);return{editorKey:n,lineHeight:r.lineHeight,style:r.style,weight:r.weight,size:r.size,fontFamily:r.family.toLowerCase(),value:"font:"+[r.style,r.variant,r.weight,r.size+"/"+r.lineHeight,a].join(" ")+";"}},u=function(){return{Title:"font_0",Menu:"font_1","Page-title":"font_2","Heading-XL":"font_3","Heading-L":"font_4","Heading-M":"font_5","Heading-S":"font_6","Body-L":"font_7","Body-M":"font_8","Body-S":"font_9","Body-XS":"font_10"}},l=function(e){var t=e.split(",");return n=t[0],r=t[1],a=t[2],"#"+d(n)+d(r)+d(a);var n,r,a};function d(e){var t=e.toString(16);return 1===t.length?"0"+t:t}var c=function(e,n,a,i){var o=i.THEME_DATA,s=t.stringUtils.startsWith(e,"alpha-");n.hasOwnProperty(e)&&!s&&(e.match("param_color_")?a.colors[e.replace("param_color_","")]=f(e,n,s,o):e.match("param_number_")?a.numbers[e.replace("param_number_","")]=+n[e]:e.match("param_boolean_")?a.booleans[e.replace("param_boolean_","")]=S(n[e]):e.match(r)&&(a.fonts[e.replace(r,"")]=p(n[e],o)))},f=function(n,r,a,i){var o=r[n],s=void 0;if(o&&!e.isString(o)&&o.value)return{themeName:void 0,value:o.value.cssColor||o.value.color.value||o.value.rgba};if(!a&&o&&e.isString(o)&&t.stringUtils.startsWith(o,"color_")){var u=(c=i,f=o,function(e,t){var n=t&&t.split("_")[1];return e[n]||t}(c.color,f));if(u=e.includes(u,",")?l(u):u,r.hasOwnProperty("alpha-"+n)&&1!==r["alpha-"+n]){var d=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{}}(u);s="rgba("+d.r+","+d.g+","+d.b+","+r["alpha-"+n]+")"}else s=u;return{themeName:o,value:s}}if(!a)return{themeName:void 0,value:o};var c,f;return{themeName:void 0,value:void 0}};var p=function(e,t){var n="object"===(void 0===e?"undefined":_typeof(e))?e.value:JSON.parse(e);return n.fontStyleParam&&"Custom"===n.preset?g(n):n.fontStyleParam&&n.theme?w(n):n.fontStyleParam?m(n,t.font):n.fontParam&&"None"===n.preset?v(n):n.fontParam&&y(n),n},g=function(e){var n=t.fonts.getFontFamilyWithFallbacks(e.family),r=e.size+"px",a=Math.floor(1.25*e.size)+"px",i="";i+="font:"+[e.style.italic?"italic":"normal","normal",e.style.bold?"bold":"normal",r+"/"+a,n].join(" ")+";",i+=e.style.underline?"text-decoration:underline;":"",e.value=i},m=function(e,t){var n=o(t)[e.preset];e.value=n.value,e.size=parseInt(n.size,10),e.family=n.fontFamily,e.style.bold="bold"===n.weight,e.style.italic="italic"===n.style,e.style.underline=!1},w=function(e){var n=t.fonts.getFontFamilyWithFallbacks(e.family),r=t.fonts.parseFontStr(e.preset);e.value="font:"+[r.style,r.variant,r.weight,r.size+"/"+r.lineHeight,n].join(" ")+";",e.size=parseInt(r.size,10),e.family=r.family.toLowerCase(),e.style.bold="bold"===r.weight,e.style.italic="italic"===r.style,e.style.underline=!1},v=function(e){var n="";n+="font-family:"+t.fonts.getFontFamilyWithFallbacks(e.family)+";font-style:"+(e.style.italic?"italic":"normal")+";font-weight:"+(e.style.bold?"bold":"normal")+";",n+=e.style.underline?"text-decoration:underline;":"",e.value=n},y=function(e){e.family=e.value,e.value=h(e),e.size=0,e.style={bold:!1,italic:!1,underline:!1}},h=function(e){var t="font-family:"+(e.cssFontFamily||e.value)+";";return t=t.replace(/''/g,"'")},S=function(t){return e.isBoolean(t)?t:"false"!==t},b=function(t,n,r,a,i){return E(e.assign(D(r,n),o(t)),a,i)},E=function(n,r,a){var i={};e.forEach(n,function(e){"string"==typeof e&&(e=JSON.parse(e)),i[e.family||e.fontFamily]=1});var o=t.fonts.getFontsUrlWithParams(i,r,a);return e.includes(o,"family=null")?"":o},D=function(t,n){var a={},i=I(t,n);return e.forEach(i,function(e,t){t.match(r)&&(a[t.replace(r,"")]=e)}),a},I=function(e,t){var n=t[e];if(!n)return null;var r=n.style&&n.style.properties;return r||null},_=function(n,r,a,i){var s=e.assign(D(i,r),o(n)),u=t.fonts,l=e(s).map(function(t){return e.isString(t)&&(t=JSON.parse(t)),t.family||t.fontFamily}).filter(function(e){return u.isUploadedFontFamily(e)}).union().value();return u.getUploadedFontFaceStyles(l,a.mediaRootUrl)};return{getMediaUrl:a,filterLegacyFonts:function(t,n){var r=["Roboto Thin","Roboto Bold","Work Sans Extra Light","Work Sans Semi Bold","Poppins Extra Light","Poppins Semi Bold","Barlow Extra Light","Barlow Medium","Oswald Extra Light","Oswald Medium","Cormorant Garamond Light","Cormorant Garamond Semi Bold","Playfair Display Bold","Dancing Script Regular","Damion","Suez One","Rozha One","Raleway Semi Bold","Lato Light","Questrial"];return e.forEach(t,function(t){t.fonts=e.reject(t.fonts,{permissions:"legacy"}),n||(t.fonts=e.reject(t.fonts,function(t){return e.includes(r,t.displayName)}))}),t},getCurrentSelectablefontsWithParams:function(r,a){var i=function(n){var r=function(e){var t=["all","legacy"];return"WixSite"===e&&t.push("studio"),t}(n),a=e.reduce(t.fonts.getFontsMetaData(),function(n,a,i){var o=a.characterSets;return e.includes(r,a.permissions)&&(a.cssFontFamily=function(n){var r=t.fonts.getFontsMetaData()[n.toLowerCase()],a=r.fontFamily,i=void 0;return r?(i=a,""!==r.fallbacks&&(i+=","+r.fallbacks),i+=","+r.genericFamily):i=n,e(i).split(",").invokeMap("replace",/.*[^\w\d\-].*/,'"$&"').join(",")}(i),e.forEach(o,function(e){n[e]||(n[e]=[]),n[e].push(a)})),n},{});return e.forOwn(a,function(t,n){a[n]=e.sortBy(t,"displayName")}),a}(r);return e(n).intersection(a).map(function(e){return{lang:e,fonts:i[e]}}).value()},getWixStoredFontsCssUrls:i,getTextPresets:o,getSiteColors:function(t){return e.reduce(t,function(t,n,r){return(r>=1&&r<=5||r>=11&&r<=35)&&t.push({name:"color_"+r,value:e.includes(n,",")?l(n):n}),t},[])},getStylesForSDK:function(t,n,r,a,o,s,u){var l=t.THEME_DATA,d={colors:{},numbers:{},booleans:{},fonts:{},googleFontsCssUrl:b(l.font,t,n,o,s),uploadFontFaces:_(l.font,t,a,n)},f=I(n,t);return f?(e.forEach(f,function(e,n){c(n,f,d,t)}),r?e.merge(d,{cssUrls:i(a,o,u)}):d):d}}}),define("warmup/lib/tpaHandlers",["lodash","warmup/lib/tpaStyleUtils"],function(e,t){"use strict";function n(t){var n=t.rendererModel.siteInfo.siteTitleSEO||"";t.publicModel&&t.publicModel.siteDisplayName&&(n=t.publicModel.siteDisplayName);var r=t.getCurrentUrlPageId(),a=t.getDataByQuery(r),i=a.title||"",o=a.pageTitleSEO||"",s=t.isHomePage(r),u=function(t,n){if(!n.isDynamicPage(t))return;var r=e.get(n.dynamicPages.headData,[t,"title"]);if(!r){var a=e.get(n.dynamicPages.data,[t,"routerDefinition","prefix"]),i=n.getRootNavigationInfo().innerRoute,o=n.rendererModel.siteInfo.siteTitleSEO||"";n.publicModel&&n.publicModel.siteDisplayName&&(o=n.publicModel.siteDisplayName);var s=o+" | "+a+" "+i;return s.trim()}return function(e){if(e)return e.replace(/["']/g,"").replace(/\n/g," ")}(r)}(r,t);return u?n=u:o?n=o:s||(n=n+" | "+i),n}return{appIsAlive:function(n,r){var a=n.rendererModel.siteInfo.documentType,i=n.getDataByQuery("masterPage").characterSets,o=n.serviceTopology,s=n.getCurrentUrlPageId(),u=e.find(n.pagesData[s].structure[n.getViewMode()],{id:r.compId}),l=e.get(u,"origCompId");l&&(u=e.find(n.pagesData[s].structure[n.getViewMode()],{id:l}));var d=e.get(u,"styleId"),c=n.pagesData.masterPage.data.theme_data.THEME_DATA,f=t.getMediaUrl(n.serviceTopology,"editorUI/fonts.v4.png"),p=t.filterLegacyFonts(t.getCurrentSelectablefontsWithParams(a,i),!0);return{fonts:{cssUrls:t.getWixStoredFontsCssUrls(o,a,!0),imageSpriteUrl:f,fontsMeta:p},siteTextPresets:t.getTextPresets(c.font),siteColors:t.getSiteColors(c.color),style:d?t.getStylesForSDK(n.pagesData.masterPage.data.theme_data,d,!1,o,a,i,!0):{}}},siteInfo:function(e){var t={},r=e.getDataByQuery(e.getCurrentUrlPageId());t.pageTitle=n(e)||"",t.siteDescription=r.descriptionSEO,t.siteKeywords=r.metaKeywordsSEO;var a=e.currentUrl;return t.url=a.full,t.baseUrl=e.getExternalBaseUrl(),t.referer=window.document.referrer,t},getCurrentPageId:function(e){return e.getCurrentUrlPageId()}}}),define("warmup/lib/postMessageHandler",["lodash","warmup/lib/tpaHandlers","experiment"],function(e,t,n){"use strict";var r=[],a=void 0,i="14409595-f076-4753-8303-9a86f9f71469",o="14bcded7-0066-7c35-14d7-466cb3f09103";function s(a,s){try{if(n.isOpen("sv_ssrLoadTpa",a)){var u=JSON.parse(s.data);if(e.isFunction(t[u.type])&&function(t,n){var r=[i,o],a=n.getCurrentUrlPageId(),s=e.find(n.pagesData[a].structure[n.getViewMode()],{id:t.compId});if(s){var u=n.getDataByQuery(s.dataQuery),l=n.rendererModel.clientSpecMap[e.get(u,"applicationId")];return e.includes(r,e.get(l,"appDefinitionId"))}return!1}(u,a)){!function(e,n,r){var a=JSON.stringify({intent:"TPA_RESPONSE",callId:e.callId,type:e.type,res:t[e.type](n,e),status:!0});r.postMessage(a,"*")}(u,a,s.source)}}}catch(e){}finally{r.push(s)}}return{registerToPostMessages:function(t){a=e.partial(s,t),window.addEventListener("message",a,!1)},flushPostMessages:function(){window.removeEventListener("message",a),e.forEach(r,function(e){window.dispatchEvent(e)}),r=null}}}),define("warmup",["lodash","zepto","experiment","warmupUtils","warmup/bi/events","warmup/lib/bodyStub","warmup/lib/layout","warmup/lib/anchorLinkHandler","warmup/lib/indicator","warmup/lib/iframesHandler","warmup/lib/postMessageHandler"],function(e,t,n,r,a,i,o,s,u,l,d){"use strict";function c(t,n,i,o){var s=t.publicModel.deviceInfo,u="Bot"===e.get(s,"browserType");r.loggingUtils.logger.reportBI(t,a.SERVER_SIDE_RENDERING_FLOW,{phase:n,status:e.defaultTo(i,!0)?1:0,warningMessage:o||null,isBot:u})}return{init:function(a,f){c(a,"did_load_warmup_packages"),t(function(){var p=!e.isUndefined(window.clientSideRender);if(c(a,"will_warmup",p,p?null:"Body not rendered"),p||(window.clientSideRender=!0,i.generate(a)),window.clientSideRender)return c(a,"did_warmup",p,e.get(window,"santaRenderingError.reason","Fallback to client")),void f();var g=window.warmupData.landingPageNavigationInfo;e.assign(a,e.pick(window.warmupData,["svgShapes","wixapps","mediaRichTextInnerComponents","userWarmup","browserDetection","externalStyles","runtimeSSR","afterSSRWithWixCode","landingPageNavigationInfo","dynamicPages","pendingBehaviours","pendingRuntimeDalChanges","clonedDataItemsIdsMap","pendingRuntimeDalChanges"]),{pagesData:window.warmupData.fullPagesData}),t("body").addClass("warmup");var m=function(t,n){var a=new r.SiteData(e.assign({},t,{pagesData:n.displayedPagesData,notRenderedStructures:n.notRenderedStructures}));return delete a.resolvedDataMaps,a.anchorsMap=n.anchorsMap,a.imagesToLayout=n.imagesToLayout,a}(a,window.warmupData);m.setRootNavigationInfo(g),m.updateScreenSize(),window.pagesData=window.pagesData||window.warmupData&&window.warmupData.fullPagesData,r.urlUtils.setPersistentCacheKiller(window.warmupData.persistentCacheKiller);var w=window.document.getElementById("SITE_CONTAINER").children[0];window.sssr.serverSantaVersion=w.getAttribute("data-santa-version"),window.sssr.serverMarkup=w.innerHTML,r.urlUtils.isTrue("ssrindicator")&&u.init(function(){!1===window.sssr.success&&window.open("https://santatools.wix.com/diverginator/?vsi="+window.wixBiSession.viewerSessionId),r.urlUtils.isTrue("ssrWarmupOnly")&&(u.updateState(u.STATES.RENDERING),f())}),d.registerToPostMessages(m),l.registerIframesOnLoad(),t("#SITE_ROOT").css({"min-height":"100%",position:"relative",margin:"0 auto"}),m.pagesDataRaw={pagesData:m.pagesData},o.runLayout(m,function(){if(r.urlUtils.isTrue("isqa")&&e.set(window,"qaApi",{emptyObjectForQA:"justForAutomationUsage",siteIsReady:function(){return!0}}),u.updateState(u.STATES.WARMUP),s.patchAnchorLinks(m,location.href),r.loggingUtils.logger.reportBeatEvent(m,"visible",g.pageId),n.isOpen("sv_ssrEmitLoadEvent",m)){var t=window.document.createEvent("Event");t.initEvent("load",!1,!1),window.dispatchEvent(t)}c(m,"did_warmup"),r.urlUtils.isTrue("ssrWarmupOnly")||n.isOpen("sv_ssrWarmupOnly",m)?u.updateState(u.STATES.STANDBY):f()})})},willRender:function(e){c(e,"will_render")},didRender:function(n,r){t("body").removeClass("warmup"),e.forEach(n.runtime.components,function(t){e.unset(t,"overrides.actionsBehaviors")}),r&&(l.flushEvents(),d.flushPostMessages(),s.restoreAnchorLinks()),u.updateState(r?u.STATES.SUCCESS:u.STATES.FAIL),c(n,"did_render",r)}}});
//# sourceMappingURL=warmup.min.js.map